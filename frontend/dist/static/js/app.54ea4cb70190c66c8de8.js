webpackJsonp([1],{"1HNN":function(t,e){},"9M+g":function(t,e){},HVK5:function(t,e){},Jmt5:function(t,e){},Kq7C:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),r=n("e6fC"),a=n.n(r),i=(n("Jmt5"),n("9M+g"),{render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("h1",{staticStyle:{color:"gray"}},[t._v("XXE lab")]),t._v(" "),n("br"),n("br"),t._v(" "),n("div",{attrs:{id:"navbar"}},[n("b-nav",{staticClass:"nav justify-content-center",attrs:{tabs:"",justified:""}},[n("b-nav-item",{attrs:{to:"/"}},[t._v("Introduction")]),t._v(" "),n("b-nav-item",{attrs:{to:"lesson1"}},[t._v("XXE-attack")]),t._v(" "),n("b-nav-item",{attrs:{to:"lesson2"}},[t._v("JAXB defence")]),t._v(" "),n("b-nav-item",{attrs:{to:"lesson3"}},[t._v("SAXReader defence")]),t._v(" "),n("b-nav-item",{attrs:{to:"lesson4"}},[t._v("XMLReader defence")]),t._v(" "),n("b-nav-item",{attrs:{to:"lesson5"}},[t._v("XMLInputFactory defence")])],1)],1),t._v(" "),n("router-view")],1)},staticRenderFns:[]});var s=n("VU/8")({name:"App"},i,!1,function(t){n("HVK5")},null,null).exports,l=n("/ocq"),c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100",staticStyle:{color:"black"}},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("Introduction")]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("\n    The goal of this lab is to introduce the widely spread security issue - XML external entity (XXE) for an IT student or a software developer, who is keen on developing and learning new things.\n    In this introduction part let's have a first glance of this security issue.")]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("\n    XXE security risk is widely spread, because it can become a vulnerability whenever XML parsing takes place.\n    For example services that change information via XML (SOAP) or the simpliest example would be an xml file upload.\n    Being vulnerable to XXE can result in losing sensitive data, do port scanning and in worst case scenario - Denial of Service.\n  ")]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("\n    Having an XXE vulnerability is all about Document Type Definitions (DTDs). By declaring DTDs and using them in the xml data makes it possible to execute remote code in the DTD.\n    Simple example of reading the etc/passwd file content:\n  ")]),t._v(" "),n("div",{staticStyle:{"font-family":"'Droid Sans Mono'","background-color":"#f9f9f9","max-width":"430px",margin:"0 auto","font-size":"10px"}},[n("p",[t._v("\n    <!DOCTYPE foo [")]),n("p",[t._v("\n  <!ELEMENT foo ANY>")]),n("p",[t._v('\n    <!ENTITY xxe SYSTEM "file:///etc/passwd">]>')]),t._v(" "),n("p",[t._v("\n    <foo>&xxe;</foo>\n  ")])]),t._v(" "),n("p",[t._v("\n    According to "),n("a",{staticStyle:{color:"black","text-decoration":"underline"},attrs:{href:"https://www.owasp.org/images/7/72/OWASP_Top_10-2017_%28en%29.pdf.pdf"}},[t._v("OWASP")]),t._v(" the easiest way of defending against XXE is to disallow DTD processing in XML parser.\n    One can disable DTDs completely or disable only external DTDs, general entities or general parameters. Here is an example how to configure XPathExpression against XXE:\n  ")]),t._v(" "),n("div",{staticStyle:{"font-family":"'Droid Sans Mono'","background-color":"#f9f9f9","max-width":"430px",margin:"0 auto","font-size":"10px"}},[n("p",[t._v("\n      DocumentBuilderFactory df = DocumentBuilderFactory.newInstance();\n      "),n("b",[t._v('df.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "");\n        df.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");')]),t._v("\n      DocumentBuilder builder = df.newDocumentBuilder();\n      String result = new XPathExpression().evaluate( builder.parse(\n      new ByteArrayInputStream(xml.getBytes())) );;\n    ")])])])}]};var u=n("VU/8")({},c,!1,function(t){n("pqbi")},"data-v-09da65ba",null).exports,d=n("mtWM"),v=n.n(d),f={name:"lesson1",data:function(){return{people:[],file:null}},mounted:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson1/people"}).then(function(e){t.people=e.data.data},function(t){console.error(t)})},methods:{getPersons:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson1/people"}).then(function(e){t.people=e.data.data},function(t){console.error(t)})},addPersion:function(){var t=new FormData;t.append("file",this.file),v()({method:"POST",url:"http://127.0.0.1:9020/xxe/lesson1/create",data:t,headers:{"content-type":"multipart/form-data"}}).then(function(t){},function(t){console.error(t)}).then(this.getPersons)}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100"},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("XXE-attack")]),t._v(" "),n("p",[t._v("In the current lesson you would need to create an xml that would demonstrate the XXE vulnerability. Study the structure from browser development tools or from backend code. On a successful attack you will see the executed code outcome from the table below. NB! use hints and solution only when really neccessary!")]),t._v(" "),n("div",{staticStyle:{width:"300px",float:"right",margin:"0 auto"}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"Take the example xml from the project source files 'People.xml' and modify according to your goal",variant:"light"}},[t._v("Hint 1")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"Declare a doctype entity where the remote code is executed and use it in one of the variables",variant:"light"}},[t._v("Hint 2")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"One of the solutions can be found in people-xxe.xml file",variant:"light"}},[t._v("Solution")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-form-file",{attrs:{accept:".xml",state:Boolean(t.file),placeholder:"Choose a file...","drop-placeholder":"Drop file here..."},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),t._v(" "),n("br"),n("br"),t._v(" "),t.file?n("b-button",{staticStyle:{width:"80px",float:"right"},attrs:{variant:"dark"},on:{click:function(e){return t.addPersion()}}},[t._v("Upload")]):n("b-button",{staticStyle:{width:"80px",float:"right"},attrs:{disabled:"",variant:"dark"}},[t._v("Upload")]),t._v(" "),n("br"),n("br")],1),t._v(" "),n("br"),n("br"),n("br"),n("br"),n("br"),t._v(" "),n("b-table",{staticClass:"table",attrs:{items:t.people}})],1)},staticRenderFns:[]};var b=n("VU/8")(f,h,!1,function(t){n("Ywy2")},"data-v-0245b320",null).exports,p={name:"lesson2",data:function(){return{solution:!1}},mounted:function(){this.getSolution()},methods:{getSolution:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson2/check"}).then(function(e){t.solution=e.data.ok},function(t){console.error(t)}).then(this.solution=!1)}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100"},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("JAXB XML parser defence")]),t._v(" "),n("p",[t._v("In the current lesson you would need to study the JAXB parser code and configure it to remove XXE vulnerability. After you have configured the xml parser, restart backend-api and check if your solution was correct. NB! use hints only when really neccessary!")]),t._v(" "),n("div",{staticStyle:{width:"300px",float:"right",margin:"0 auto"}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"JAXB parser method for current lesson can be found in Lesson2Service.java",variant:"light"}},[t._v("Hint 1")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XXE vulnerability can be removed by setting SaxParserFactory features like 'http://xml.org/sax/features/external-general-entities', 'http://xml.org/sax/features/external-parameter-entities' and 'http://apache.org/xml/features/nonvalidating/load-external-dtd' to false",variant:"light"}},[t._v("Hint 2")]),t._v(" "),n("br"),n("br"),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{staticStyle:{width:"200px",float:"right"},attrs:{variant:"dark"},on:{click:function(e){return t.getSolution()}}},[t._v("Check for solution")]),t._v(" "),n("br"),n("br"),n("br"),t._v(" "),n("div",[n("b-alert",{attrs:{show:t.solution,variant:"success"}},[t._v("\n        Your solution is correct, good job!\n      ")]),t._v(" "),n("b-alert",{attrs:{show:!t.solution,variant:"danger"}},[t._v("\n        Solution is incorrect!\n      ")])],1)],1)])},staticRenderFns:[]};var _=n("VU/8")(p,m,!1,function(t){n("1HNN")},"data-v-88bef5f6",null).exports,g={name:"lesson2",data:function(){return{solution:!1}},mounted:function(){this.getSolution()},methods:{getSolution:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson3/check"}).then(function(e){t.solution=e.data.ok},function(t){console.error(t)}).then(this.solution=!1)}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100"},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("SAXReader defence")]),t._v(" "),n("p",[t._v("In the current lesson you would need to study the SAXReader code and configure it to remove XXE vulnerability. After you have configured the xml parser, restart backend-api and check if your solution was correct. NB! use hints only when really neccessary!")]),t._v(" "),n("div",{staticStyle:{width:"300px",float:"right",margin:"0 auto"}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"SAXReader method for current lesson can be found in Lesson3Service.java",variant:"light"}},[t._v("Hint 1")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XXE vulnerability can be removed by setting SAXReader features like 'http://xml.org/sax/features/external-general-entities', 'http://xml.org/sax/features/external-parameter-entities' to false and 'http://apache.org/xml/features/disallow-doctype-decl' to true",variant:"light"}},[t._v("Hint 2")]),t._v(" "),n("br"),n("br"),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{staticStyle:{width:"200px",float:"right"},attrs:{variant:"dark"},on:{click:function(e){return t.getSolution()}}},[t._v("Check for solution")]),t._v(" "),n("br"),n("br"),n("br"),t._v(" "),n("div",[n("b-alert",{attrs:{show:t.solution,variant:"success"}},[t._v("\n        Your solution is correct, good job!\n      ")]),t._v(" "),n("b-alert",{attrs:{show:!t.solution,variant:"danger"}},[t._v("\n        Solution is incorrect!\n      ")])],1)],1)])},staticRenderFns:[]};var x=n("VU/8")(g,y,!1,function(t){n("Kq7C")},"data-v-b0e8dbd0",null).exports,w={name:"lesson2",data:function(){return{solution:!1}},mounted:function(){this.getSolution()},methods:{getSolution:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson4/check"}).then(function(e){t.solution=e.data.ok},function(t){console.error(t)})}}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100"},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("XMLReader defence")]),t._v(" "),n("p",[t._v("In the current lesson you would need to study the XMLReader code and configure it to remove XXE vulnerability. After you have configured the xml parser, restart backend-api and check if your solution was correct. NB! use hints only when really neccessary!")]),t._v(" "),n("div",{staticStyle:{width:"300px",float:"right",margin:"0 auto"}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XMLReader method for current lesson can be found in Lesson4Service.java",variant:"light"}},[t._v("Hint 1")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XXE vulnerability can be removed by setting XMLReader features like 'http://xml.org/sax/features/external-general-entities', 'http://xml.org/sax/features/external-parameter-entities' and 'http://apache.org/xml/features/nonvalidating/load-external-dtd' to false and/or 'http://apache.org/xml/features/disallow-doctype-decl' to true",variant:"light"}},[t._v("Hint 2")]),t._v(" "),n("br"),n("br"),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{staticStyle:{width:"200px",float:"right"},attrs:{variant:"dark"},on:{click:function(e){return t.getSolution()}}},[t._v("Check for solution")]),t._v(" "),n("br"),n("br"),n("br"),t._v(" "),n("div",[n("b-alert",{attrs:{show:t.solution,variant:"success"}},[t._v("\n        Your solution is correct, good job!\n      ")]),t._v(" "),n("b-alert",{attrs:{show:!t.solution,variant:"danger"}},[t._v("\n        Solution is incorrect!\n      ")])],1)],1)])},staticRenderFns:[]};var k=n("VU/8")(w,S,!1,function(t){n("vdH2")},"data-v-d6f11f54",null).exports,X={name:"lesson2",data:function(){return{solution:!1}},mounted:function(){this.getSolution()},methods:{getSolution:function(){var t=this;v()({method:"GET",url:"http://127.0.0.1:9020/xxe/lesson5/check"}).then(function(e){t.solution=e.data.ok},function(t){console.error(t)})}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container h-100"},[n("br"),n("br"),n("br"),t._v(" "),n("h2",[t._v("XMLInputFactory defence")]),t._v(" "),n("p",[t._v("In the current lesson you would need to study the XMLInputFactory code and configure it to remove XXE vulnerability. After you have configured the xml parser, restart backend-api and check if your solution was correct. NB! use hints only when really neccessary!")]),t._v(" "),n("div",{staticStyle:{width:"300px",float:"right",margin:"0 auto"}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XMLInputFactory method for current lesson can be found in Lesson5Service.java",variant:"light"}},[t._v("Hint 1")]),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.click",modifiers:{click:!0}}],staticStyle:{float:"right"},attrs:{title:"XXE vulnerability can be removed by setting XMLInputFactory property 'XMLInputFactory.SUPPORT_DTD' to false, if you only want to disable external entities change property 'javax.xml.stream.isSupportingExternalEntities' to false",variant:"light"}},[t._v("Hint 2")]),t._v(" "),n("br"),n("br"),t._v(" "),n("br"),n("br"),t._v(" "),n("b-button",{staticStyle:{width:"200px",float:"right"},attrs:{variant:"dark"},on:{click:function(e){return t.getSolution()}}},[t._v("Check for solution")]),t._v(" "),n("br"),n("br"),n("br"),t._v(" "),n("div",[n("b-alert",{attrs:{show:t.solution,variant:"success"}},[t._v("\n        Your solution is correct, good job!\n      ")]),t._v(" "),n("b-alert",{attrs:{show:!t.solution,variant:"danger"}},[t._v("\n        Solution is incorrect!\n      ")])],1)],1)])},staticRenderFns:[]};var L=n("VU/8")(X,E,!1,function(t){n("Swom")},"data-v-b4ffdb00",null).exports;o.default.use(l.a);var A=new l.a({routes:[{path:"/",name:"introduction",component:u},{path:"/lesson1",name:"Lesson1",component:b},{path:"/lesson2",name:"Lesson2",component:_},{path:"/lesson3",name:"Lesson3",component:x},{path:"/lesson4",name:"Lesson4",component:k},{path:"/lesson5",name:"Lesson5",component:L}]});o.default.config.productionTip=!1,o.default.use(a.a),new o.default({el:"#app",router:A,components:{App:s},template:"<App/>"})},Swom:function(t,e){},Ywy2:function(t,e){},pqbi:function(t,e){},vdH2:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.54ea4cb70190c66c8de8.js.map